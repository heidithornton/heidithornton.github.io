<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>ACUMHPS.knit</title>
    <meta charset="utf-8" />
    <script src="2021-ACU-HT_files/header-attrs/header-attrs.js"></script>
    <link href="2021-ACU-HT_files/remark-css/default.css" rel="stylesheet" />
    <script src="2021-ACU-HT_files/htmlwidgets/htmlwidgets.js"></script>
    <script src="2021-ACU-HT_files/jquery/jquery.min.js"></script>
    <link href="2021-ACU-HT_files/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
    <script src="2021-ACU-HT_files/datatables-binding/datatables.js"></script>
    <link href="2021-ACU-HT_files/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="2021-ACU-HT_files/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="2021-ACU-HT_files/dt-core/js/jquery.dataTables.min.js"></script>
    <link href="2021-ACU-HT_files/crosstalk/css/crosstalk.css" rel="stylesheet" />
    <script src="2021-ACU-HT_files/crosstalk/js/crosstalk.min.js"></script>
    <link href="2021-ACU-HT_files/jquery-sparkline/jquery.sparkline.css" rel="stylesheet" />
    <script src="2021-ACU-HT_files/jquery-sparkline/jquery.sparkline.js"></script>
    <script src="2021-ACU-HT_files/sparkline-binding/sparkline.js"></script>
    <link rel="stylesheet" href="heidi.css" type="text/css" />
    <link rel="stylesheet" href="HEIDI-~1.CSS" type="text/css" />
  </head>
  <body>
    <textarea id="source">


class: left, top
background-image: url("ACU MHPS 2021/Images/Metricon 2.jpg")
background-size: cover
opacity: 0.5
# Using R and Power BI in Sport
#### Heidi Thornton, PhD | ACU High-Performance Sport Seminar



---





class: left

background-image: url("ACU MHPS 2021/Images/Home.jpg")
background-position: 100% 50%
background-size: 40% 65%

# About me



üëãI'm an applied sports scientist

--

I currently work with two üèàteams

--

- Gold Coast Suns Football Club (AFL)


- Newcastle Knights Rugby League Club (NRL)

--

I use R and Power BI daily

--

Outside of work, I love running and the gym üèãÔ∏è‚Äç‚ôÄÔ∏è

--

üìåI live in an pretty amazing place (Newcastle)

---

class: center, middle


&lt;font size="20"&gt; 'Start with the end in mind' &lt;/font&gt;


### Credit to [Dr Jacquie Tran](https://jacquietran.github.io/2019_essa_forum/R/#1)


---
class: left

# Why not just use excel?


Both [Alice Sweeting](http://sportstatisticsrsweet.rbind.io/) and [Jacquie Tran](https://www.jacquietran.com/) have presented on this previously

--

BUT the general story is....


.pull-left[
&lt;img src="https://media.giphy.com/media/Sb9KqeeymLlESGWZyE/giphy.gif" width="45%" /&gt;

]
--

.pull-right[
&lt;img src="https://media.giphy.com/media/Rhhr8D5mKSX7O/giphy.gif" width="65%" /&gt;
]


---

class: left

# Lets get started

‚ùó I'm skipping the setup of R and Power BI as there are **tonnes** of resources available (see end of presentation)

--

‚úîÔ∏è We will create a GPS match report in R **without** touching Excel
 
--

üîë Firstly, we need to install a few R **packages**


```r
Packages &lt;- c('readxl','tidyverse','dplyr','ggplot2', 'sparkline', 'kableExtra', 'data.table',
              'formattable', 'DT')

# Install listed packages
install.packages(Packages)
```
&lt;br&gt;

&lt;img src="ACU MHPS 2021/Images/readxl.png" width="9%" /&gt;&lt;img src="ACU MHPS 2021/Images/tidyverse.jpg" width="9%" /&gt;&lt;img src="ACU MHPS 2021/Images/dplyr.png" width="9%" /&gt;&lt;img src="ACU MHPS 2021/Images/catapultR.png" width="9%" /&gt;&lt;img src="ACU MHPS 2021/Images/KableExtra.jpg" width="9%" /&gt;&lt;img src="ACU MHPS 2021/Images/ggplot2.jpg" width="9%" /&gt;&lt;img src="ACU MHPS 2021/Images/datatable.png" width="9%" /&gt;&lt;img src="ACU MHPS 2021/Images/R.jpg" width="9%" /&gt;

---

# CatapultR package

‚úîÔ∏è **`catapultR`** is a new R package developed by Catapult 

--

.pull-left[It allows users to pull data directly from their cloud] 


&lt;img src="https://media.giphy.com/media/l4HodBpDmoMA5p9bG/giphy.gif" width="23%" style="display: block; margin: auto;" /&gt;

--

üî® **`catapultR`** is still a demo version


üîú You can download it, but Catapult aren't accepting new users just yet



```r
# Install catapultR
devtools::install_bitbucket("catapultsports/catapultr")
library(catapultR)
```


---

# Pull sessions from the cloud

<svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:black;overflow:visible;position:relative;"><path d="M416 112c-17.6 0-32 14.4-32 32v72c0 4.4-3.6 8-8 8h-16c-4.4 0-8-3.6-8-8V64c0-17.6-14.4-32-32-32s-32 14.4-32 32v152c0 4.4-3.6 8-8 8h-16c-4.4 0-8-3.6-8-8V32c0-17.6-14.4-32-32-32s-32 14.4-32 32v184c0 4.4-3.6 8-8 8h-16c-4.4 0-8-3.6-8-8V64c0-17.6-14.4-32-32-32S96 46.4 96 64v241l-23.6-32.5c-13-17.9-38-21.8-55.9-8.8s-21.8 38-8.8 55.9l125.6 172.7c9 12.4 23.5 19.8 38.8 19.8h197.6c22.3 0 41.6-15.3 46.7-37l26.5-112.7c3.2-13.7 4.9-28.3 5.1-42.3V144c0-17.6-14.4-32-32-32zM176 416c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm0-96c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm64 128c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm0-96c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm64 32c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm32 64c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm32-128c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16z"/></svg> These credentials are for presentation purposes only (need your own)

üîë This token allows us to query your cloud and access data using the catapult API



```r
# token &lt;- ofCloudGetToken(sRegion = "America", sName = "brian_wsoccer_demo", sPwd = "d3cCM4yvh6",
                         # sClientID = "h9vrcJ3FXxY71HDzdU0a6C4QLt5VjoOunABsRlK8", 
                         # sClientSecret = "STe67MbNGfkO5XH8jaZDyoQvnz4VBYiL0Clg2RcW")
```


There is a link to request access to catapultR - https://docs.google.com/forms/d/e/1FAIpQLScv8w7OHvzdR05_M-Piu1rNJU9OPzIwsBfLNvY56RZx_nnU_g/viewform


---

# View activities

‚úîÔ∏è Now we have saved our account token details, we can select what session/game we want to select





```r
# View activities
activities &lt;- ofCloudGetActivities(token)
glimpse(activities)
```

```
## Rows: 1,210
## Columns: 19
## $ id             &lt;chr&gt; "6e035081-1e4b-4b13-b0ba-e27aa5a454e2", "77895525-cf54-~
## $ name           &lt;chr&gt; "210821SatAFLRd23vsSydney", "Activity 20210821075312", ~
## $ start_time     &lt;int&gt; 1629517523, 1629496354, 1629423083, 1629323771, 1629244~
## $ end_time       &lt;int&gt; 1629526735, 1629511575, 1629425226, 1629327783, 1629249~
## $ modified_at    &lt;chr&gt; "2021-08-27 01:56:35", "2021-08-21 02:36:28", "2021-08-~
## $ game_id        &lt;chr&gt; "6e035081-1e4b-4b13-b0ba-e27aa5a454e2", "77895525-cf54-~
## $ owner_id       &lt;chr&gt; "0d2d37ee-9879-4987-9189-bc0cd388bb98", "4b6264d6-cf87-~
## $ owner          &lt;df[,10]&gt; &lt;data.frame[26 x 10]&gt;
## $ periods        &lt;list&gt; [&lt;data.frame[4 x 4]&gt;], [&lt;data.frame[1 x 4]&gt;], [&lt;dat~
## $ tags           &lt;list&gt; &lt;"LPS", "Saturday", "Full", "T6Full"&gt;, "GPS", &lt;"Friday~
## $ tag_list       &lt;list&gt; [&lt;data.frame[4 x 5]&gt;], [&lt;data.frame[1 x 5]&gt;], [&lt;data.f~
## $ athlete_count  &lt;int&gt; 23, 8, 26, 8, 31, 3, 6, 23, 14, 28, 3, 39, 7, 32, 23, ~
## $ period_count   &lt;int&gt; 4, 1, 1, 9, 16, 1, 7, 4, 4, 1, 7, 16, 10, 5, 4, 7, 14, ~
## $ venue_name     &lt;chr&gt; "AFL Q", "AFL Q", "AFL Q", "AFL Q", "AFL Q", "AFL Q", "~
## $ venue_width    &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 159, 0, 0, 0, 0, 0, 0, 0, 159, ~
## $ venue_length   &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 159, 0, 0, 0, 0, 0, 0, 0, 159, ~
## $ venue_rotation &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, -179, 0, 0, 0, 0, 0, 0, 0, -179~
## $ venue_lat      &lt;dbl&gt; 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0~
## $ venue_lng      &lt;dbl&gt; 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,~
```



```r
# Select what activities we want to report on
target &lt;- c("210529SatAFLRd11vsHawthorn","210522SatAFLRd10vsGeelong","210515SatAFLRd9vsBrisbane",
            "210508Rd8vsStKilda","210501SatAFLRd7vsCollingwood","210424SatAFLRd6vsSydney",
            "210417SatAFLRd5vsWesternBulldogs","210410SatAFLRd4vsCarlton",
            "210402FriAFLRd3vsAdelaide","210327Rd2vsNorthMelbourne","210321SunAFLRd1vsWestCoast")

activities &lt;- filter(activities, name %in% target)
```



---

# View parameters

<svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:black;overflow:visible;position:relative;"><path d="M432 160H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0 256H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM108.1 96h231.81A12.09 12.09 0 0 0 352 83.9V44.09A12.09 12.09 0 0 0 339.91 32H108.1A12.09 12.09 0 0 0 96 44.09V83.9A12.1 12.1 0 0 0 108.1 96zm231.81 256A12.09 12.09 0 0 0 352 339.9v-39.81A12.09 12.09 0 0 0 339.91 288H108.1A12.09 12.09 0 0 0 96 300.09v39.81a12.1 12.1 0 0 0 12.1 12.1z"/></svg> Now lets see what parameters are available to view

Currently, there are **1046** metrics available 


```r
# view parameters
parameters &lt;- ofCloudGetParameters(token)
glimpse(parameters)
```

```
## Rows: 1,046
## Columns: 6
## $ id                &lt;chr&gt; "00025054-617c-45f1-ae03-a768ebfcd893", "003eb200-19~
## $ parameter_type_id &lt;chr&gt; "417654ed-209f-4c6f-a028-62c10f873d18", "65344b9a-85~
## $ name              &lt;chr&gt; "IMA Accel Medium", "Velocity Band 2 Average Effort ~
## $ original_name     &lt;chr&gt; "IMA Accel Medium", "Velocity Band 2 Average Effort ~
## $ slug              &lt;chr&gt; "ima_band2_accel_count", "velocity_band2_average_eff~
## $ calculation       &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "", "", "", ~
```



---

# Create dataset

<svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:black;overflow:visible;position:relative;"><path d="M448 240v96c0 3.084-.356 6.159-1.063 9.162l-32 136C410.686 499.23 394.562 512 376 512H168a40.004 40.004 0 0 1-32.35-16.473l-127.997-176c-12.993-17.866-9.043-42.883 8.822-55.876 17.867-12.994 42.884-9.043 55.877 8.823L104 315.992V40c0-22.091 17.908-40 40-40s40 17.909 40 40v200h8v-40c0-22.091 17.908-40 40-40s40 17.909 40 40v40h8v-24c0-22.091 17.908-40 40-40s40 17.909 40 40v24h8c0-22.091 17.908-40 40-40s40 17.909 40 40zm-256 80h-8v96h8v-96zm88 0h-8v96h8v-96zm88 0h-8v96h8v-96z"/></svg> Using our credentials, we can now select what metrics we want





```r
data &lt;- ofCloudGetStatistics(
        token, params = c("date","athlete_name","total_duration","total_distance",
              "meterage_per_minute","velocity_band6_total_distance","max_vel"), 
  
  groupby = c("athlete", "activity"), 
            filters = list(name = "activity_id",
                           comparison = "=",
                           values = activities$id))
```


--

```r
head(data, n=3)
```

```
##         date       Name total_distance total_duration  max_vel
## 1 21/03/2021 Athlete 41       13000.07        5753.67 30.75762
## 2 27/03/2021 Athlete 41       12280.45        5510.38 33.12540
## 3 02/04/2021 Athlete 41       11235.87        4722.58 30.84264
##   velocity_band6_total_distance meterage_per_minute
## 1                        341.81            135.5664
## 2                        353.66            133.7162
## 3                        377.41            142.7508
```

---

# Summarise data 

 <svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:black;overflow:visible;position:relative;"><path d="M332.8 320h38.4c6.4 0 12.8-6.4 12.8-12.8V172.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v134.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V76.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v230.4c0 6.4 6.4 12.8 12.8 12.8zm-288 0h38.4c6.4 0 12.8-6.4 12.8-12.8v-70.4c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v70.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V108.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v198.4c0 6.4 6.4 12.8 12.8 12.8zM496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16z"/></svg> Using the **`dplyr`** package, we will replicate what we might normally do with a **pivot table** to summarise our data

--


```r
data &lt;- data %&gt;%
    mutate(date=as.Date(as.character(date), format = "%d/%m/%Y")) %&gt;%
  
    group_by(date, Name) %&gt;%
              summarize(
                  Duration=sum(total_duration)/60,
                  Speed_mmin=mean(meterage_per_minute),
                  Distance=sum(total_distance),
                  HSR=sum(velocity_band6_total_distance),
                  Max_velocity=max(max_vel))
```


--



```
## # A tibble: 5 x 7
## # Groups:   date [1]
##   date       Name       Duration Speed_mmin Distance   HSR Max_velocity
##   &lt;date&gt;     &lt;chr&gt;         &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;
## 1 2021-03-21 Athlete 13    100.        116.   11582.  99.9         27.9
## 2 2021-03-21 Athlete 14    101.        138.   13994. 337.          29.4
## 3 2021-03-21 Athlete 2      86.8       149.   12902.  60.6         26.7
## 4 2021-03-21 Athlete 20     89.7       127.   11403.  19.8         26.2
## 5 2021-03-21 Athlete 23     72.9       139.   10120. 272.          31.3
```


---
# Sparklines

--
.pull-left[
<svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:black;overflow:visible;position:relative;"><path d="M496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16zM464 96H345.94c-21.38 0-32.09 25.85-16.97 40.97l32.4 32.4L288 242.75l-73.37-73.37c-12.5-12.5-32.76-12.5-45.25 0l-68.69 68.69c-6.25 6.25-6.25 16.38 0 22.63l22.62 22.62c6.25 6.25 16.38 6.25 22.63 0L192 237.25l73.37 73.37c12.5 12.5 32.76 12.5 45.25 0l96-96 32.4 32.4c15.12 15.12 40.97 4.41 40.97-16.97V112c.01-8.84-7.15-16-15.99-16z"/></svg> Sparklines are HTML widgets that can summarise data nicely in reports


I think of them as 'mini graphs' ü§∑

&lt;img src="ACU MHPS 2021/Images/sparklinetable.png" width="55%" /&gt;
]

--
.pull-right[


```r
sparklines &lt;- data %&gt;%
      group_by(Name) %&gt;% 
      arrange(date) %&gt;%
  summarize(
    Distance_SPK = spk_chr(
      round(Distance, 0),
        type='line',
        fillColor = "transparent",
        RangeMin = mean(Distance)-(sd(Distance)*0.5),
        RangeMax = mean(Distance)+(sd(Distance)*0.5),
        chartRangeClip = T,
        width = 100, height = 15),
    
    Duration_SPK = spk_chr(
        round(Duration, 0),
        type='line',
        fillColor = "transparent",
        RangeMin = mean(Duration)-(sd(Duration)*0.5),
        RangeMax = mean(Duration)+(sd(Duration)*0.5),
        chartRangeClip = T,
        width = 100,height = 15))
```



]

---
# Sparklines dataset










---

# Merge data frames

<svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:black;overflow:visible;position:relative;"><path d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"/></svg> First we need to merge the summary data and sparklines together using the **`dplyr`** package

<svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:black;overflow:visible;position:relative;"><path d="M487.976 0H24.028C2.71 0-8.047 25.866 7.058 40.971L192 225.941V432c0 7.831 3.821 15.17 10.237 19.662l80 55.98C298.02 518.69 320 507.493 320 487.98V225.941l184.947-184.97C520.021 25.896 509.338 0 487.976 0z"/></svg> Then filter by the date we want to report on
--


```r
combined &lt;- full_join(data, sparklines, by = c("Name")) %&gt;%
                      filter(date == "2021-05-29")

head(combined, n=5)
```

```
## # A tibble: 5 x 10
## # Groups:   date [1]
##   date       Name   Duration Speed_mmin Distance   HSR Max_velocity Distance_SPK
##   &lt;date&gt;     &lt;chr&gt;     &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt; &lt;html&gt;      
## 1 2021-05-29 Athle~     14.4       143.    2062. 173.          30.7 "&lt;span id=\~
## 2 2021-05-29 Athle~    114.        134.   15259. 359.          32.1 "&lt;span id=\~
## 3 2021-05-29 Athle~     96.9       123.   11920. 155.          32.3 "&lt;span id=\~
## 4 2021-05-29 Athle~     92.2       132.   12187.  85.7         28.1 "&lt;span id=\~
## 5 2021-05-29 Athle~     86.2       141.   12142.  50.6         28.6 "&lt;span id=\~
## # ... with 2 more variables: Duration_SPK &lt;html&gt;, Speed_mmin_SPK &lt;html&gt;
```

---

# GPS report - Version 1

First we will create a basic table with limited formatting using the **`formattable`** package

--


```r
library(formattable)

formattable(combined, align = c('c'), list(options =list(dom ='tp')))
```

--


&lt;table class="table table-condensed"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; date &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Name &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Duration &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Speed_mmin &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Distance &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; HSR &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Max_velocity &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Distance_SPK &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Duration_SPK &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Speed_mmin_SPK &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 2021-05-29 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Athlete 9 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 117.4733 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 116.0014 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 13627.07 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 53.62 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 29.68420 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-672495a6168ad6bd217d" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-672495a6168ad6bd217d"&gt;{"x":{"values":[11876,14013,13358,14210,14204,13443,12816,12681,11514,14292,13627],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":12798.9545612611,"normalRangeMax":13752.6425587389,"chartRangeClip":true,"chartRangeMinX":1,"chartRangeMinX.1":60,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-b4d748fc9ebdb1432eba" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-b4d748fc9ebdb1432eba"&gt;{"x":{"values":[106,117,122,125,128,112,112,114,103,128,117],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":112.629401311607,"normalRangeMax":121.045901718696,"chartRangeClip":true,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-e6f3cf4189aa10f83b57" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-e6f3cf4189aa10f83b57"&gt;{"x":{"values":[112,120,109,113,111,120,114,112,112,111,116],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":111.94199681885,"normalRangeMax":115.408412272059,"chartRangeClip":true,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 2021-05-29 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Athlete 14 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 114.2290 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 133.5855 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 15259.34 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 359.05 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 32.12881 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-608102498d20e0b43937" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-608102498d20e0b43937"&gt;{"x":{"values":[13994,14273,14253,15225,16513,15746,14731,14435,14855,15339,15259],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":14592.3836661635,"normalRangeMax":15339.1089756547,"chartRangeClip":true,"chartRangeMinX":1,"chartRangeMinX.1":60,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-33bd0fc6f1999a39d849" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-33bd0fc6f1999a39d849"&gt;{"x":{"values":[101,106,105,114,127,119,107,103,114,113,114],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":107.328021860506,"normalRangeMax":115.035493291009,"chartRangeClip":true,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-065a7324419a4b66103a" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-065a7324419a4b66103a"&gt;{"x":{"values":[138,135,135,134,130,132,138,140,130,136,134],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":133.197880505247,"normalRangeMax":136.375994040208,"chartRangeClip":true,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 2021-05-29 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Athlete 32 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 112.0963 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 138.6244 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 15539.29 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 399.11 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 30.27415 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-0190b4b402ecae64bf95" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-0190b4b402ecae64bf95"&gt;{"x":{"values":[13203,14522,11999,15693,15305,14211,14477,12834,14669,15539],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":13636.7765758708,"normalRangeMax":14853.6352041292,"chartRangeClip":true,"chartRangeMinX":1,"chartRangeMinX.1":60,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-cd9192812bac33d16f43" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-cd9192812bac33d16f43"&gt;{"x":{"values":[96,105,90,119,117,103,104,93,111,112],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":100.045973727323,"normalRangeMax":109.895626272677,"chartRangeClip":true,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-b1f991bd895ab9ae2d23" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-b1f991bd895ab9ae2d23"&gt;{"x":{"values":[138,139,133,132,132,137,140,138,132,139],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":134.21596480739,"normalRangeMax":137.52307319261,"chartRangeClip":true,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 2021-05-29 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Athlete 28 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 111.5465 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 121.7306 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 13578.62 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 235.78 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 28.60774 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-2aa13d0288cf7252a16a" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-2aa13d0288cf7252a16a"&gt;{"x":{"values":[12498,13583,13864,14485,15037,14073,12365,13150,13368,14441,13579],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":13264.7073252413,"normalRangeMax":14088.1855820314,"chartRangeClip":true,"chartRangeMinX":1,"chartRangeMinX.1":60,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-69cfc1015d9ca9cb36ee" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-69cfc1015d9ca9cb36ee"&gt;{"x":{"values":[91,102,104,110,116,108,93,99,104,116,112],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":100.67910878847,"normalRangeMax":109.125982120621,"chartRangeClip":true,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-b68a9ee0ba32d3ea09c9" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-b68a9ee0ba32d3ea09c9"&gt;{"x":{"values":[138,133,134,132,130,131,133,133,128,125,122],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":128.398855615205,"normalRangeMax":132.892960748432,"chartRangeClip":true,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 2021-05-29 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Athlete 4 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 108.8887 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 109.8003 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 11956.00 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 28.44 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 26.01875 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-ae666eca5a3212acddb9" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-ae666eca5a3212acddb9"&gt;{"x":{"values":[12133,13762,13052,11999,11912,11632,12141,12805,12673,11956],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":12079.7243109113,"normalRangeMax":12733.2584570887,"chartRangeClip":true,"chartRangeMinX":1,"chartRangeMinX.1":60,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-9c033560708a323e607a" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-9c033560708a323e607a"&gt;{"x":{"values":[109,120,118,107,106,107,104,118,126,109],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":108.380223752687,"normalRangeMax":115.862142913979,"chartRangeClip":true,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-4c1c3e7e9dd068f738a8" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-4c1c3e7e9dd068f738a8"&gt;{"x":{"values":[112,115,110,112,113,109,117,109,101,110],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":108.635743407367,"normalRangeMax":112.992846592633,"chartRangeClip":true,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 2021-05-29 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Athlete 30 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 108.0282 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 134.8545 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 14568.09 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 548.45 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 35.88166 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-b3a77fd85c207384df5a" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-b3a77fd85c207384df5a"&gt;{"x":{"values":[13119,12377,13275,15047,14672,13715,12060,13362,14181,14952,14568],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":13248.5636421865,"normalRangeMax":14265.8789396317,"chartRangeClip":true,"chartRangeMinX":1,"chartRangeMinX.1":60,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-0f2e5b0f9a65e6072251" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-0f2e5b0f9a65e6072251"&gt;{"x":{"values":[94,88,98,110,112,101,85,94,107,112,108],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":95.9916759859909,"normalRangeMax":105.544778559464,"chartRangeClip":true,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-0bf004b8a36b4ff5ce68" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-0bf004b8a36b4ff5ce68"&gt;{"x":{"values":[140,140,136,137,132,136,141,142,133,133,135],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":135.006259655701,"normalRangeMax":138.594565798844,"chartRangeClip":true,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 2021-05-29 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Athlete 41 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 106.3490 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 137.5965 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 14633.25 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 468.82 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 31.78578 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-b3a83c5f4cafb59a6a28" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-b3a83c5f4cafb59a6a28"&gt;{"x":{"values":[13000,12280,11236,13889,11920,5017,13810,14633],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":10458.9621259303,"normalRangeMax":13487.4840440697,"chartRangeClip":true,"chartRangeMinX":1,"chartRangeMinX.1":60,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-8eab2712c89ccef6a250" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-8eab2712c89ccef6a250"&gt;{"x":{"values":[96,92,79,105,88,31,105,106],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":75.2942319238201,"normalRangeMax":100.394476409513,"chartRangeClip":true,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-8482f2dc34ac0d7c99a2" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-8482f2dc34ac0d7c99a2"&gt;{"x":{"values":[136,134,143,132,135,164,131,138],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":133.48800222144,"normalRangeMax":144.33161027856,"chartRangeClip":true,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 2021-05-29 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Athlete 37 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 105.3603 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 132.4269 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 13952.54 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 300.39 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 32.25472 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-2b2758da4aa006e2e9da" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-2b2758da4aa006e2e9da"&gt;{"x":{"values":[11451,13563,13783,14861,15244,13930,13749,12628,13533,14477,13953],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":13225.9629221477,"normalRangeMax":14260.0916505796,"chartRangeClip":true,"chartRangeMinX":1,"chartRangeMinX.1":60,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-9eb11f4bbf1576e36e95" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-9eb11f4bbf1576e36e95"&gt;{"x":{"values":[83,103,103,117,117,106,103,97,107,110,105],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":99.9734519562204,"normalRangeMax":109.291426831658,"chartRangeClip":true,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; &lt;span id="htmlwidget-f85cb51e8e516809487c" class="sparkline html-widget"&gt;&lt;/span&gt;
&lt;script type="application/json" data-for="htmlwidget-f85cb51e8e516809487c"&gt;{"x":{"values":[138,132,133,127,131,132,134,130,126,132,132],"options":{"type":"line","fillColor":"transparent","spotColor":false,"normalRangeMin":129.964895052553,"normalRangeMax":133.146946765629,"chartRangeClip":true,"height":15,"width":100},"width":100,"height":15},"evals":[],"jsHooks":[]}&lt;/script&gt; &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# GPS report - Version 2

‚úîÔ∏è A few more steps with this one, but worth it for the final product


```r
combined &lt;- combined[c(1,3,10,4,11,5,9,7)] %&gt;%
    filter(Duration &gt; 98) %&gt;%
        ungroup() %&gt;%

formattable::formattable
        list(Duration = color_tile("white","indianred"),
             Speed_mmin = color_tile("white","indianred"),
             Distance = color_tile("white","indianred"),
             Max_velocity = color_tile("white","lightgreen"))) %&gt;%
  
formattable::as.datatable(rownames = FALSE, 
              class = 'white-space: nowrap',
              colnames = c("Name","Duration (mins)","Duration trend","Speed (m.min) ","Speed trend",
                           " Distance (m)","Distance trend","Max speed (m.s)"), 
              options = list(dom = 'tp', bPaginate=FALSE, 
              columnDefs = list(className = 'dt-center', targets = "_all")),
                    fnDrawCallback = htmlwidgets::
                    JS('function(){HTMLWidgets.staticRender();}')) %&gt;% 
      spk_add_deps() %&gt;%
      formatStyle(c(1,3,5,7), `border-right` = "solid 1px", `border-color` = "darkgrey")
```

---

# GPS Report - Version 2 outut

<div id="htmlwidget-4ed32ce9b37d411372f3" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-4ed32ce9b37d411372f3">{"x":{"filter":"none","data":[["Athlete 9 ","Athlete 14","Athlete 28","Athlete 32","Athlete 4 ","Athlete 30","Athlete 41","Athlete 26","Athlete 3 ","Athlete 37","Athlete 8 ","Athlete 38"],["<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #cd5c5c\">117<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #d67a7a\">114<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #dc8e8e\">112<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #dc8e8e\">112<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #e6adad\">109<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #e9b7b7\">108<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #efcccc\">106<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #f2d6d6\">105<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #f2d6d6\">105<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #f2d6d6\">105<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #f5e0e0\">104<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff\">101<\/span>"],["<span id=\"htmlwidget-c43d10c82823b4108ad0\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-c43d10c82823b4108ad0\">{\"x\":{\"values\":[106,117,122,125,128,112,112,114,103,128,117],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":112.525541482352,\"normalRangeMax\":120.929003972194,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>","<span id=\"htmlwidget-1f95af1a817beef23fc5\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-1f95af1a817beef23fc5\">{\"x\":{\"values\":[101,106,105,114,127,119,107,103,114,113,114],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":107.335923085627,\"normalRangeMax\":115.02771327801,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script> ","<span id=\"htmlwidget-4b2fd06ee13f59382fdf\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-4b2fd06ee13f59382fdf\">{\"x\":{\"values\":[91,102,104,110,116,108,93,99,104,116,112],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":100.780995378054,\"normalRangeMax\":109.219004621946,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>   ","<span id=\"htmlwidget-98f5c2c2823307d4b878\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-98f5c2c2823307d4b878\">{\"x\":{\"values\":[96,105,90,119,117,103,104,93,111,112],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":100.05586767527,\"normalRangeMax\":109.94413232473,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>         ","<span id=\"htmlwidget-47cf89ccdaea1c3d6b08\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-47cf89ccdaea1c3d6b08\">{\"x\":{\"values\":[109,120,118,107,106,107,104,118,126,109],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":108.679187663366,\"normalRangeMax\":116.120812336634,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>    ","<span id=\"htmlwidget-b375d6918dfd8a1391e9\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-b375d6918dfd8a1391e9\">{\"x\":{\"values\":[94,88,98,110,112,101,85,94,107,112,108],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":95.9714397071438,\"normalRangeMax\":105.66492392922,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>      ","<span id=\"htmlwidget-e8bb1d99c9cb52d8fcbf\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-e8bb1d99c9cb52d8fcbf\">{\"x\":{\"values\":[96,92,79,105,88,31,105,106],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":75.3410458596567,\"normalRangeMax\":100.158954140343,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>                 ","<span id=\"htmlwidget-f579ada2d4d3a69dbc87\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-f579ada2d4d3a69dbc87\">{\"x\":{\"values\":[103,117,119,123,122,104,109,109,108,113,105],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":108.380607785829,\"normalRangeMax\":115.619392214171,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>","<span id=\"htmlwidget-dc9b89f0db393e253387\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-dc9b89f0db393e253387\">{\"x\":{\"values\":[96,100,105],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":98.0787084569219,\"normalRangeMax\":102.587958209745,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>                                 ","<span id=\"htmlwidget-e1987d46b2097952e5cc\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-e1987d46b2097952e5cc\">{\"x\":{\"values\":[83,103,103,117,117,106,103,97,107,110,105],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":99.9551633240894,\"normalRangeMax\":109.317563948638,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>  ","<span id=\"htmlwidget-c5547bc8ebb2f25fe9a7\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-c5547bc8ebb2f25fe9a7\">{\"x\":{\"values\":[104,95,116,88,81,91,87,101,104],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":90.890448069064,\"normalRangeMax\":101.776218597603,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>              ","<span id=\"htmlwidget-e0dfba847b864b099d7c\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-e0dfba847b864b099d7c\">{\"x\":{\"values\":[93,108,111,116,105,108,96,105,96,104,101],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":100.427320199706,\"normalRangeMax\":107.390861618475,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>   "],["<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #f0d1d1\">116<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #d47575\">134<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #e7b2b2\">122<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #cd5c5c\">139<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #faefef\">110<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #d37070\">135<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ce6161\">138<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff\">107<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #d16b6b\">136<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #d77f7f\">132<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #d16b6b\">136<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #d77f7f\">132<\/span>"],["<span id=\"htmlwidget-6f00369c94e43289ec0f\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-6f00369c94e43289ec0f\">{\"x\":{\"values\":[112,120,109,113,111,120,114,112,112,111,116],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":111.82980991072,\"normalRangeMax\":115.442917362007,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script> ","<span id=\"htmlwidget-a413e6eb103ed268fbba\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-a413e6eb103ed268fbba\">{\"x\":{\"values\":[138,135,135,134,130,132,138,140,130,136,134],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":133.113412307489,\"normalRangeMax\":136.341133147057,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>","<span id=\"htmlwidget-b3e8f3752c9887e30d79\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-b3e8f3752c9887e30d79\">{\"x\":{\"values\":[138,133,134,132,130,131,133,133,128,125,122],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":128.595366240832,\"normalRangeMax\":133.040997395532,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>","<span id=\"htmlwidget-76cc9c488bb7ce046f22\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-76cc9c488bb7ce046f22\">{\"x\":{\"values\":[138,139,133,132,132,137,140,138,132,139],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":134.333333333333,\"normalRangeMax\":137.666666666667,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>    ","<span id=\"htmlwidget-591fcc3ad026370372c1\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-591fcc3ad026370372c1\">{\"x\":{\"values\":[112,115,110,112,113,109,117,109,101,110],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":108.642326355642,\"normalRangeMax\":112.957673644358,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>    ","<span id=\"htmlwidget-bd658b41d9234746df9b\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-bd658b41d9234746df9b\">{\"x\":{\"values\":[140,140,136,137,132,136,141,142,133,133,135],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":135.074361560555,\"normalRangeMax\":138.562002075808,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>","<span id=\"htmlwidget-887e635c1b621a5ec03d\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-887e635c1b621a5ec03d\">{\"x\":{\"values\":[136,134,143,132,135,164,131,138],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":133.763513665569,\"normalRangeMax\":144.486486334431,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>            ","<span id=\"htmlwidget-e3a74745ac4a30260cb7\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-e3a74745ac4a30260cb7\">{\"x\":{\"values\":[110,105,104,104,112,107,107,108,110,109,107],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":106.253873414367,\"normalRangeMax\":108.837035676542,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>","<span id=\"htmlwidget-c6ae40573388ccf0333d\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-c6ae40573388ccf0333d\">{\"x\":{\"values\":[128,132,136],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":130,\"normalRangeMax\":134,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>                                                          ","<span id=\"htmlwidget-2cd184c85b95b9933791\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-2cd184c85b95b9933791\">{\"x\":{\"values\":[138,132,133,127,131,132,134,130,126,132,132],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":129.927374875543,\"normalRangeMax\":133.163534215366,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>","<span id=\"htmlwidget-1a5f9b642fead38ce7f7\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-1a5f9b642fead38ce7f7\">{\"x\":{\"values\":[127,132,121,134,138,140,136,134,136],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":130.180193545266,\"normalRangeMax\":136.042028676956,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>        ","<span id=\"htmlwidget-2c6428879c4495c031f6\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-2c6428879c4495c031f6\">{\"x\":{\"values\":[132,129,130,132,132,127,134,129,129,118,132],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":127.305549917514,\"normalRangeMax\":131.603540991577,\"chartRangeClip\":true,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>"],["<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #e3a5a5\">13627<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #d06666\">15259<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #e4a7a7\">13579<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #cd5c5c\">15539<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #f7e6e6\">11956<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #d88181\">14568<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #d77e7e\">14633<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff\">11310<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #dc8d8d\">14254<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #df9999\">13953<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #dd9090\">14172<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #e7b3b3\">13280<\/span>"],["<span id=\"htmlwidget-bc9b4e33fca9ba5d770a\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-bc9b4e33fca9ba5d770a\">{\"x\":{\"values\":[11876,14013,13358,14210,14204,13443,12816,12681,11514,14292,13627],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":12798.9259603372,\"normalRangeMax\":13752.7104032992,\"chartRangeClip\":true,\"chartRangeMinX\":1,\"chartRangeMinX.1\":60,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>","<span id=\"htmlwidget-e8043128b6cbec7ed8ce\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-e8043128b6cbec7ed8ce\">{\"x\":{\"values\":[13994,14273,14253,15225,16513,15746,14731,14435,14855,15339,15259],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":14592.3448889095,\"normalRangeMax\":15339.1096565451,\"chartRangeClip\":true,\"chartRangeMinX\":1,\"chartRangeMinX.1\":60,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>","<span id=\"htmlwidget-61bcfca791769e1acb55\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-61bcfca791769e1acb55\">{\"x\":{\"values\":[12498,13583,13864,14485,15037,14073,12365,13150,13368,14441,13579],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":13264.9028774631,\"normalRangeMax\":14088.3698498096,\"chartRangeClip\":true,\"chartRangeMinX\":1,\"chartRangeMinX.1\":60,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>","<span id=\"htmlwidget-c3ff77a855c20e61c51c\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-c3ff77a855c20e61c51c\">{\"x\":{\"values\":[13203,14522,11999,15693,15305,14211,14477,12834,14669,15539],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":13636.7542204381,\"normalRangeMax\":14853.6457795619,\"chartRangeClip\":true,\"chartRangeMinX\":1,\"chartRangeMinX.1\":60,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>      ","<span id=\"htmlwidget-431ed6f6c8418e45508e\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-431ed6f6c8418e45508e\">{\"x\":{\"values\":[12133,13762,13052,11999,11912,11632,12141,12805,12673,11956],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":12079.7927533708,\"normalRangeMax\":12733.2072466292,\"chartRangeClip\":true,\"chartRangeMinX\":1,\"chartRangeMinX.1\":60,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>      ","<span id=\"htmlwidget-ba374ba760467372f962\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-ba374ba760467372f962\">{\"x\":{\"values\":[13119,12377,13275,15047,14672,13715,12060,13362,14181,14952,14568],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":13248.4600776156,\"normalRangeMax\":14265.7217405662,\"chartRangeClip\":true,\"chartRangeMinX\":1,\"chartRangeMinX.1\":60,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>","<span id=\"htmlwidget-91b9071a2c8d7b2d34e7\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-91b9071a2c8d7b2d34e7\">{\"x\":{\"values\":[13000,12280,11236,13889,11920,5017,13810,14633],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":10458.8817086047,\"normalRangeMax\":13487.3682913953,\"chartRangeClip\":true,\"chartRangeMinX\":1,\"chartRangeMinX.1\":60,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>                   ","<span id=\"htmlwidget-6512a7c01443737a383d\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-6512a7c01443737a383d\">{\"x\":{\"values\":[11285,12306,12407,12789,13584,11073,11630,11797,11932,12377,11310],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":11672.3710758171,\"normalRangeMax\":12416.7198332738,\"chartRangeClip\":true,\"chartRangeMinX\":1,\"chartRangeMinX.1\":60,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>","<span id=\"htmlwidget-9c372fb1c68c9f92480f\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-9c372fb1c68c9f92480f\">{\"x\":{\"values\":[12347,13177,14254],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":12781.2521861069,\"normalRangeMax\":13737.4144805598,\"chartRangeClip\":true,\"chartRangeMinX\":1,\"chartRangeMinX.1\":60,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>                                                ","<span id=\"htmlwidget-4cf7b7bf733add189c5d\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-4cf7b7bf733add189c5d\">{\"x\":{\"values\":[11451,13563,13783,14861,15244,13930,13749,12628,13533,14477,13953],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":13225.8168624553,\"normalRangeMax\":14260.0013193628,\"chartRangeClip\":true,\"chartRangeMinX\":1,\"chartRangeMinX.1\":60,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>","<span id=\"htmlwidget-08a762036ca94918c370\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-08a762036ca94918c370\">{\"x\":{\"values\":[13293,12506,14044,11725,11226,12765,11905,13498,14172],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":12271.805720732,\"normalRangeMax\":13313.5276126014,\"chartRangeClip\":true,\"chartRangeMinX\":1,\"chartRangeMinX.1\":60,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>             ","<span id=\"htmlwidget-9129ef110ed8b96a4fb6\" class=\"sparkline html-widget\"><\/span>\n<script type=\"application/json\" data-for=\"htmlwidget-9129ef110ed8b96a4fb6\">{\"x\":{\"values\":[12241,13954,14505,15327,13890,13706,12869,13475,12367,12266,13280],\"options\":{\"type\":\"line\",\"fillColor\":\"transparent\",\"spotColor\":false,\"normalRangeMin\":12954.9551652704,\"normalRangeMax\":13932.3175620023,\"chartRangeClip\":true,\"chartRangeMinX\":1,\"chartRangeMinX.1\":60,\"height\":15,\"width\":100},\"width\":100,\"height\":15},\"evals\":[],\"jsHooks\":[]}<\/script>"],["<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #d7f8d7\">8.2<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #bbf4bb\">8.9<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #e3fae3\">7.9<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #cff7cf\">8.4<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff\">7.2<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #90ee90\">10.0<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #bff5bf\">8.8<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #cff7cf\">8.4<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #dffadf\">8.0<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #b7f4b7\">9.0<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #e7fbe7\">7.8<\/span> ","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #dbf9db\">8.1<\/span> "]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>Name<\/th>\n      <th>Duration (mins)<\/th>\n      <th>Duration trend<\/th>\n      <th>Speed (m.min) <\/th>\n      <th>Speed trend<\/th>\n      <th> Distance (m)<\/th>\n      <th>Distance trend<\/th>\n      <th>Max speed (m.s)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tp","bPaginate":false,"columnDefs":[{"className":"dt-center","targets":"_all"}],"fnDrawCallback":"function(){HTMLWidgets.staticRender();}","order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[0]; $(this.api().cell(row, 0).node()).css({'border-right':'solid 1px','border-color':'darkgrey'});\nvar value=data[2]; $(this.api().cell(row, 2).node()).css({'border-right':'solid 1px','border-color':'darkgrey'});\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'border-right':'solid 1px','border-color':'darkgrey'});\nvar value=data[6]; $(this.api().cell(row, 6).node()).css({'border-right':'solid 1px','border-color':'darkgrey'});\n}"}},"evals":["options.fnDrawCallback","options.rowCallback"],"jsHooks":[]}</script>

---

# Power BI

<svg aria-hidden="true" role="img" viewBox="0 0 384 512" style="height:1em;width:0.75em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm60.1 106.5L224 336l60.1 93.5c5.1 8-.6 18.5-10.1 18.5h-34.9c-4.4 0-8.5-2.4-10.6-6.3C208.9 405.5 192 373 192 373c-6.4 14.8-10 20-36.6 68.8-2.1 3.9-6.1 6.3-10.5 6.3H110c-9.5 0-15.2-10.5-10.1-18.5l60.3-93.5-60.3-93.5c-5.2-8 .6-18.5 10.1-18.5h34.8c4.4 0 8.5 2.4 10.6 6.3 26.1 48.8 20 33.6 36.6 68.5 0 0 6.1-11.7 36.6-68.5 2.1-3.9 6.2-6.3 10.6-6.3H274c9.5-.1 15.2 10.4 10.1 18.4zM384 121.9v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"/></svg>  If you know how to use **Microsoft Excel**, you'll already know parts of **Microsoft Power BI**

--

üìà Create simple, powerful visualisations, in a time efficient manner

--

 <svg aria-hidden="true" role="img" viewBox="0 0 288 512" style="height:1em;width:0.56em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M209.2 233.4l-108-31.6C88.7 198.2 80 186.5 80 173.5c0-16.3 13.2-29.5 29.5-29.5h66.3c12.2 0 24.2 3.7 34.2 10.5 6.1 4.1 14.3 3.1 19.5-2l34.8-34c7.1-6.9 6.1-18.4-1.8-24.5C238 74.8 207.4 64.1 176 64V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48h-2.5C45.8 64-5.4 118.7.5 183.6c4.2 46.1 39.4 83.6 83.8 96.6l102.5 30c12.5 3.7 21.2 15.3 21.2 28.3 0 16.3-13.2 29.5-29.5 29.5h-66.3C100 368 88 364.3 78 357.5c-6.1-4.1-14.3-3.1-19.5 2l-34.8 34c-7.1 6.9-6.1 18.4 1.8 24.5 24.5 19.2 55.1 29.9 86.5 30v48c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-48.2c46.6-.9 90.3-28.6 105.7-72.7 21.5-61.6-14.6-124.8-72.5-141.7z"/></svg> It's **free** (desktop version)

--

üëâ All calculations/formulas can be done directly in **Power BI**

--

‚úîÔ∏è Download direct from the internet

&lt;br&gt;

&lt;img src="ACU MHPS 2021/Images/pb.png" width="15%" style="display: block; margin: auto;" /&gt;



---

# Power BI report

<svg aria-hidden="true" role="img" viewBox="0 0 581 512" style="height:1em;width:1.13em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> Create a drill intensity report also using R showing intensity of drills compared to the peak of a game for 3 metrics 

--
&lt;img src="2021-ACU-HT_files/figure-html/power bi report 2-1.png" width="55%" style="display: block; margin: auto;" /&gt;


---

# Power BI data

üëâ Repeat similiar steps using **`catapultR`** and added in **period name** (drill name)

--





```r
# token &lt;- ofCloudGetToken(sRegion = "APAC, sName = " Acc name", sPwd = "acc password",
                        # sClientID = "ID", ClientSecret = "secret")

activities &lt;- ofCloudGetActivities(token)
activities &lt;-filter(activities, activities$name=="210609Wed")

# Pull through most recent data
data &lt;- ofCloudGetStatistics(token, 
                             
  params = c("date", "activity_name","athlete_name","period_name","start_time_h","end_time_h", 
             "total_duration","meterage_per_minute","hirmin","acceleration_density"), 
  
  groupby = c("athlete", "period", "activity"), 
  filters = list(name = "activity_id",
                 comparison = "=",
                 values = activities$id[1]))

data$total_duration &lt;- as.numeric(data$total_duration)/60
write.csv(data, row.names=FALSE, "assets/data.csv") # Export data
```

---

# Create Power BI report


- Open power BI and connect data using **Get Data** button

- Calculate **% game intensity** columns using pre-determined **intercept** (peak intensity) and **slope** (decrement) values

- Add a table and select columns you want (averages)
--

&lt;br&gt;

.pull-left[
&lt;img src="ACU MHPS 2021/Images/Int Slope.png" width="95%" /&gt;

]

.pull-right[
&lt;img src="ACU MHPS 2021/Images/Formula.png" width="110%" /&gt;

]


--



.footnote[
**References** &lt;br&gt;
Delaney et al. (2017). Modelling the decrement in running intensity within professional soccer players. Science and Medicine in Football. &lt;br&gt;
Duthie et al. (2018). Running intensities in elite youth soccer by age. Journla of Strength and Conditioning Research. 
]
---

# Formatting


üö¶	Colour code the table to reflect the intensity of each drill using **conditional formatting** rules 
 
- Below: 0-89%
- At: 90-109%
- Above: 110-129%
- Above: 130%+

&lt;br&gt;
 
&lt;img src="ACU MHPS 2021/Images/Power BI formatting rules.png" width="50%" /&gt;


---

# Power BI report version 2


üíπ Alternatively, we can select other options such as data bars, icons, font colour etc


&lt;img src="ACU MHPS 2021/Images/Ticks.png" width="110%" /&gt;

---

# Useful Resources

catapultR - http://catapultr.catapultsports.com/download_catapultR.html

Mitch Henderson - https://www.mitchhenderson.org/

Alice Sweeting - http://sportstatisticsrsweet.rbind.io/

Josh Trewin - http://futbolanalysr.rbind.io/

Neil Collins - https://www.sportscidata.com/

Jose Fernandez - https://twitter.com/jfernandez__

---

class: center, middle

# Thank you and good luck!

#### <svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:black;overflow:visible;position:relative;"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg> [heidi.thornton@goldcoastfc.com.au](mailto:heidi.thornton@goldcoastfc.com.au)&lt;br&gt;
#### <svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:black;overflow:visible;position:relative;"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> [heidithornton09](https://twitter.com/heidithornton09)&lt;br&gt;


    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": true,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
